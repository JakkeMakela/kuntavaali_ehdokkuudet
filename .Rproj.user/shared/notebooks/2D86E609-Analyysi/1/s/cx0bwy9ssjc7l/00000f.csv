"0",""
"0","#Get raw data; Only need to run once"
"0","if (F){"
"0",""
"0","headerNames <- c(""vaalityyppi"", ""kuntanro"", ""vaalipiiri"", ""puolue"", ""kunta"","
"0","                 ""etunimi"", ""sukunimi"", ""ika"", ""ammatti"","
"0","                 ""aiempi"")"
"0",""
"0","getData <- function(vuosi,datadir, datafile, "
"0","                    sarakkeet = c(1,3,6,12,16,18,19,21,22,32),"
"0","                    headerNames = c(""vuosi"", ""vaalityyppi"","
"0","                                    ""kuntanro"","
"0","                                    ""vaalipiiri"", ""puolue"", "
"0","                                    ""kunta"", ""etunimi"", "
"0","                                    ""sukunimi"", ""ika"", "
"0","                                    ""ammatti"", ""aiempi"")){"
"0","  "
"0",""
"0","    data <- read_csv2(paste0(datadir,""/"", datafile), col_names=FALSE) %>%"
"0","    "
"0","#  data <- read.xlsx(paste0(datadir,""/"", datafile),"
"0","#                    colNames=FALSE) %>%"
"0","    select(all_of(sarakkeet)) %>% "
"0","  #    mutate(aiempi = as.numeric(aiempi)) %>%"
"0","    mutate(vuosi=vuosi) %>%"
"0","    relocate(vuosi)"
"0","  "
"0","  colnames(data) <- headerNames"
"0","  "
"0","  # data <- data %>%"
"0","  #       mutate(puolue = str_trim(puolue),"
"0","  #          vaalipiiri = str_trim(vaalipiiri),"
"0","  #          kunta = str_trim(kunta),"
"0","  #          etunimi = str_trim(etunimi),"
"0","  #          sukunimi = str_trim(sukunimi),"
"0","  #          ammatti = str_trim(ammatti)) "
"0","  "
"0","  return(data)"
"0","}"
"0",""
"0",""
"0",""
"0","data2021 <- getData(2021, ""data"", ""ehd_maa_2021.csv"")"
"0",""
"0",""
"0","data2017 <- getData(2017, ""data"", ""ehd_maa_2017.csv"")"
"0",""
"0",""
"0","data2012 <- getData(2012, ""data"", ""ehd_maa_2012.csv"") "
"0",""
"0","fulldata <- data2021 %>%"
"0","  bind_rows(data2017) %>%"
"0","  bind_rows(data2012)"
"0",""
"0","saveRDS(fulldata, paste0(cleanDataDir,""/kuntavaalidata.rds""))"
"0",""
"0","}"
"0",""
